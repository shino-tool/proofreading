from .utils import get_gemini_response

def process(text, creativity=0.7, model_name="gemini-1.5-pro"):
    """
    Applies humanization logic to the text.
    """
    
    prompt = f"""
    あなたはプロの編集者です。以下のテキストはAIによって生成された可能性があります。
    このテキストを詳細に分析し、「AIっぽさ」を排除して、人間が書いたような自然で温度感のある文章にリライトしてください。

    # 具体的な指示
    1. **接続詞の削減**: 「また」「さらに」「しかし」「したがって」などの論理的な接続詞を減らし、文脈の流れで自然に繋げてください。
    2. **文末の多様化**: 「〜です」「〜ます」の単調な連続を避け、体言止め、倒置法、問いかけ（〜ですよね？）などを適度に混ぜてリズム（Burstiness）を作ってください。
    3. **断定回避の修正**: 「〜と言えるでしょう」「〜と考えられます」という曖昧な表現を、文脈が許す限り「〜だ」「〜です」と言い切る形に強めてください。
    4. **抽象語の具体化**: 「革新的な」「包括的な」などのマジックワードがあれば、より具体的な言葉や平易な表現に書き換えてください。
    5. **主観の注入**: 必要に応じて、書き手の感情や温度感が伝わる副詞（「なんと」「やっぱり」など）を自然な範囲で加えてください。
    6. **元の意味の維持**: 文章の主張や事実は変えないでください。

    # 入力テキスト
    {text}

    # リライト後のテキスト
    """
    
    return get_gemini_response(prompt, temperature=creativity, model_name=model_name)
